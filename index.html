<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Right Spot - Music Player</title>
    <style>
        :root {
            --background: #121212;
            --background-elevated: #1e1e1e;
            --background-highlight: #1a1a1a;
            --text-base: #ffffff;
            --text-subdued: #a7a7a7;
            --accent-base: #1ed760;
            --accent-hover: #1fdf64;
            --decorative-subdued: #292929;
            --essential-negative: #e91429;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; overflow: hidden; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        body { background: var(--background); color: var(--text-base); -webkit-font-smoothing: antialiased; }

        .app-container {
            display: flex;
            height: calc(100% - 90px);
            position: relative;
        }

        /* SIDEBAR */
        .sidebar {
            width: 280px;
            background: var(--background-elevated);
            padding: 24px 12px;
            display: flex;
            flex-direction: column;
            gap: 24px;
            overflow-y: auto;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 0 12px;
            font-size: 22px;
            font-weight: 700;
        }

        .logo svg {
            width: 40px;
            height: 40px;
            fill: var(--text-base);
        }

        .nav-menu {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 12px 16px;
            color: var(--text-subdued);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.2s ease;
            font-size: 14px;
            font-weight: 700;
        }

        .nav-item.active, .nav-item:hover {
            color: var(--text-base);
            background: var(--background-highlight);
        }

        .nav-item svg {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }

        .playlist-list {
            flex: 1;
            overflow-y: auto;
        }

        .playlist-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 8px 16px;
            color: var(--text-subdued);
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .playlist-item:hover {
            color: var(--text-base);
            background: var(--background-highlight);
        }

        .playlist-count {
            margin-left: auto;
            font-size: 12px;
            color: var(--text-subdued);
        }

        /* MAIN CONTENT */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            background: linear-gradient(to bottom, #1a1a1a 0%, var(--background) 40%);
        }

        .top-bar {
            height: 64px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 32px;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(8px);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .menu-toggle {
            display: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: none;
            border: none;
            color: var(--text-subdued);
            cursor: pointer;
        }

        .search-container {
            display: flex;
            align-items: center;
            background: var(--background-elevated);
            border-radius: 500px;
            padding: 8px 16px;
            width: 400px;
            max-width: 100%;
            transition: all 0.2s ease;
        }

        .search-container:focus-within {
            background: rgba(0,0,0,.5);
            box-shadow: 0 0 0 2px var(--text-base);
        }

        .search-icon {
            width: 24px;
            height: 24px;
            fill: var(--text-subdued);
            margin-right: 12px;
        }

        .search-input {
            background: none;
            border: none;
            color: var(--text-base);
            outline: none;
            flex: 1;
            font-size: 14px;
        }

        .search-input::placeholder {
            color: var(--text-subdued);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--background-elevated);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
            cursor: pointer;
        }

        .content-area {
            flex: 1;
            padding: 24px 32px;
            overflow-y: auto;
        }

        .page {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 24px;
            letter-spacing: -0.04em;
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .section-subtitle {
            font-size: 24px;
            font-weight: 700;
            letter-spacing: -0.04em;
        }

        .see-all-btn {
            font-size: 14px;
            font-weight: 700;
            color: var(--text-subdued);
            text-decoration: none;
            transition: color 0.2s ease;
        }

        .see-all-btn:hover {
            color: var(--text-base);
        }

        /* CONTENT GRIDS */
        .content-row {
            margin-bottom: 48px;
        }

        .quick-access-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 16px;
            margin-bottom: 48px;
        }

        .quick-access-item {
            display: flex;
            align-items: center;
            background: var(--background-elevated);
            border-radius: 4px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .quick-access-item:hover {
            background: var(--background-highlight);
            transform: translateY(-2px);
        }

        .quick-access-item img {
            width: 80px;
            height: 80px;
            border-radius: 4px;
            margin-right: 16px;
        }

        .quick-access-item span {
            font-size: 16px;
            font-weight: 700;
        }

        .recent-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 24px;
        }

        .recent-item {
            background: var(--background-elevated);
            border-radius: 8px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .recent-item:hover {
            background: var(--background-highlight);
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.3);
        }

        .recent-item-cover {
            width: 100%;
            aspect-ratio: 1;
            border-radius: 8px;
            margin-bottom: 16px;
        }

        .recent-item-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .recent-item-subtitle {
            font-size: 14px;
            color: var(--text-subdued);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .track-result-card {
            background: var(--background-elevated);
            border-radius: 8px;
            padding: 16px;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
        }

        .track-result-card:hover {
            background: var(--background-highlight);
        }

        .track-result-cover {
            width: 100%;
            aspect-ratio: 1;
            border-radius: 8px;
            margin-bottom: 16px;
        }

        .track-result-play-btn {
            position: absolute;
            bottom: 24px;
            right: 24px;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: var(--accent-base);
            border: none;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transform: translateY(8px);
            transition: all 0.2s ease;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }

        .track-result-card:hover .track-result-play-btn {
            opacity: 1;
            transform: translateY(0);
        }

        .track-result-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .track-result-artist {
            font-size: 14px;
            color: var(--text-subdued);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* BOTTOM PLAYER */
        .bottom-player {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 90px;
            background: var(--background-elevated);
            border-top: 1px solid var(--decorative-subdued);
            display: flex;
            align-items: center;
            padding: 0 16px;
            gap: 16px;
            z-index: 1000;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .bottom-player.hidden {
            transform: translateY(100%);
            opacity: 0;
        }

        .now-playing-section {
            display: flex;
            align-items: center;
            gap: 14px;
            width: 30%;
            min-width: 180px;
        }

        .now-playing-cover {
            width: 56px;
            height: 56px;
            border-radius: 4px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .now-playing-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
            min-width: 0;
            flex: 1;
        }

        .now-playing-title {
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .now-playing-artist {
            font-size: 12px;
            color: var(--text-subdued);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .now-playing-actions {
            display: flex;
            gap: 8px;
        }

        .now-playing-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: none;
            border: none;
            color: var(--text-subdued);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .now-playing-btn:hover {
            color: var(--text-base);
        }

        .player-controls-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            flex: 1;
            max-width: 722px;
        }

        .player-controls {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .control-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: none;
            border: none;
            color: var(--text-subdued);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .control-btn:hover {
            color: var(--text-base);
        }

        .play-btn {
            width: 40px;
            height: 40px;
            background: var(--text-base);
            color: var(--background);
        }

        .playback-progress {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%;
        }

        .time {
            font-size: 11px;
            color: var(--text-subdued);
            min-width: 40px;
        }

        .progress-bar {
            flex: 1;
            height: 4px;
            background: var(--decorative-subdued);
            border-radius: 2px;
            cursor: pointer;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: var(--text-base);
            border-radius: 2px;
            width: 0%;
            transition: width 0.1s linear;
        }

        .player-extras-section {
            display: flex;
            align-items: center;
            gap: 16px;
            width: 30%;
            min-width: 180px;
            justify-content: flex-end;
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 120px;
        }

        .volume-slider {
            flex: 1;
            height: 4px;
            background: var(--decorative-subdued);
            border-radius: 2px;
            outline: none;
            cursor: pointer;
            -webkit-appearance: none;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 12px;
            height: 12px;
            background: var(--text-base);
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .volume-slider:hover::-webkit-slider-thumb {
            opacity: 1;
        }

        /* LEGAL MODAL */
        .modal-backdrop {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            backdrop-filter: blur(4px);
        }

        .modal-backdrop.visible {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal {
            background: var(--background-elevated);
            border-radius: 12px;
            padding: 32px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            width: 90%;
            box-shadow: 0 16px 48px rgba(0,0,0,0.5);
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
            letter-spacing: -0.04em;
        }

        .modal-close {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: none;
            border: none;
            color: var(--text-subdued);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            color: var(--text-base);
            background: var(--background-highlight);
        }

        .modal-content {
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-subdued);
        }

        .modal-content h3 {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-base);
            margin: 20px 0 8px;
        }

        .modal-content p {
            margin-bottom: 12px;
        }

        /* FOOTER */
        .footer {
            margin-top: 80px;
            padding: 40px 0 80px;
            border-top: 1px solid var(--decorative-subdued);
            text-align: center;
            background: linear-gradient(to top, #000 0%, transparent 100%);
        }

        .footer-logo {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 16px;
            color: var(--text-subdued);
            text-decoration: none;
        }

        .footer-logo:hover {
            color: var(--text-base);
        }

        .footer-logo svg {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }

        .footer-copyright {
            font-size: 12px;
            color: var(--text-subdued);
            margin-bottom: 8px;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 24px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        .footer-link {
            font-size: 12px;
            color: var(--text-subdued);
            text-decoration: none;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .footer-link:hover {
            color: var(--text-base);
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: 0;
                top: 0;
                height: 100%;
                z-index: 1001;
                transform: translateX(-100%);
            }

            .sidebar.visible {
                transform: translateX(0);
            }

            .sidebar-backdrop {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.8);
                z-index: 1000;
            }

            .sidebar-backdrop.visible {
                display: block;
            }

            .menu-toggle {
                display: flex;
            }

            .recent-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }

            .bottom-player {
                flex-direction: column;
                height: auto;
                padding: 12px;
                gap: 12px;
            }

            .volume-control {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .content-area {
                padding: 16px;
            }

            .recent-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 16px;
            }

            .footer-links {
                flex-direction: column;
                gap: 12px;
            }
        }

        /* ERROR DISPLAY */
        .error-banner {
            background: var(--essential-negative);
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            margin: 16px 0;
            font-size: 14px;
            display: none;
        }

        .error-banner.visible {
            display: block;
        }

        .debug-info {
            font-family: monospace;
            font-size: 11px;
            opacity: 0.7;
            margin-top: 8px;
        }
    </style>
</head>
<body>
    <!-- Mobile sidebar backdrop -->
    <div class="sidebar-backdrop" id="sidebarBackdrop"></div>
    
    <!-- Error Banner -->
    <div class="error-banner" id="errorBanner">
        <strong>Error:</strong> <span id="errorMessage"></span>
        <div class="debug-info" id="debugInfo"></div>
    </div>

    <!-- Legal Modal -->
    <div class="modal-backdrop" id="legalModal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Legal Information</h2>
                <button class="modal-close" onclick="closeLegalModal()">‚úï</button>
            </div>
            <div class="modal-content" id="modalContent"></div>
        </div>
    </div>

    <div class="app-container">
        <!-- SIDEBAR -->
        <aside class="sidebar" id="sidebar" role="navigation">
            <div class="logo">Right Spot</div>
            <nav class="nav-menu" role="menubar">
                <a href="#" class="nav-item active" data-page="home" role="menuitem">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
                    <span>Home</span>
                </a>
                <a href="#" class="nav-item" data-page="search" role="menuitem">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27A6.47 6.47 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                    <span>Search</span>
                </a>
                <a href="#" class="nav-item" data-page="library" role="menuitem">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z"/></svg>
                    <span>Your Library</span>
                </a>
            </nav>
            <div class="playlist-list" id="playlistList">
                <div class="playlist-item" onclick="showLikedSongs()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                    <span>Liked Songs</span>
                    <span class="playlist-count" id="likedCount">0</span>
                </div>
                <div class="playlist-item" onclick="showRecentlyPlayed()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M13 3a9 9 0 0 0-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42A8.954 8.954 0 0 0 13 21a9 9 0 0 0 0-18zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"/></svg>
                    <span>Recently Played</span>
                    <span class="playlist-count" id="recentCount">0</span>
                </div>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            <header class="top-bar" role="banner">
                <button class="menu-toggle" id="menuToggle" aria-label="Open menu">‚ò∞</button>
                <div class="search-container" role="search">
                    <svg class="search-icon" viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27A6.47 6.47 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                    <input type="text" class="search-input" id="searchInput" placeholder="What do you want to listen to?" autocomplete="off">
                </div>
                <div class="user-avatar" title="User Profile">U</div>
            </header>

            <div class="content-area">
                <!-- HOME PAGE -->
                <div class="page active" id="homePage" role="main">
                    <h1 class="section-title">Good evening</h1>
                    <div class="quick-access-grid">
                        <div class="quick-access-item" onclick="playLikedShuffle()">
                            <img src="https://misc.scdn.co/liked-songs/liked-songs-300.png" alt="Liked Songs">
                            <span>Liked Songs<br><small style="color: var(--text-subdued);">Shuffle play</small></span>
                        </div>
                        <div class="quick-access-item" onclick="playRecent()">
                            <img src="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=300&h=300&fit=crop" alt="Recently Played">
                            <span>Recently Played<br><small style="color: var(--text-subdued);">Continue listening</small></span>
                        </div>
                        <div class="quick-access-item" onclick="searchGenre('pop hits')">
                            <img src="https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=300&h=300&fit=crop" alt="Popular">
                            <span>Popular Hits<br><small style="color: var(--text-subdued);">Trending now</small></span>
                        </div>
                        <div class="quick-access-item" onclick="searchGenre('lofi chill')">
                            <img src="https://images.unsplash.com/photo-1506157786151-b8491531f063?w=300&h=300&fit=crop" alt="Chill">
                            <span>Chill Vibes<br><small style="color: var(--text-subdued);">Relax & focus</small></span>
                        </div>
                    </div>

                    <div class="content-row">
                        <div class="section-header">
                            <h2 class="section-subtitle">Recently played</h2>
                            <a href="#" class="see-all-btn" onclick="showRecentlyPlayed(); return false;">See all</a>
                        </div>
                        <div class="recent-grid" id="recentGrid"></div>
                    </div>

                    <div class="content-row">
                        <div class="section-header">
                            <h2 class="section-subtitle">Made for you</h2>
                            <a href="#" class="see-all-btn" onclick="searchGenre('recommended'); return false;">See all</a>
                        </div>
                        <div class="recent-grid" id="madeForYouGrid"></div>
                    </div>

                    <div class="content-row">
                        <div class="section-header">
                            <h2 class="section-subtitle">Popular & Trending</h2>
                            <a href="#" class="see-all-btn" onclick="searchGenre('trending'); return false;">See all</a>
                        </div>
                        <div class="recent-grid" id="popularGrid"></div>
                    </div>

                    <!-- FOOTER -->
                    <footer class="footer">
                        <div class="footer-logo">
                            <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 14.5v-9l6 4.5-6 4.5z"/></svg>
                            <span>Right Spot</span>
                        </div>
                        <p class="footer-copyright">Copyright 2025-2026 RightSpot LLC - All Rights Reserved</p>
                        <div class="footer-links">
                            <span class="footer-link" onclick="showLegal('terms')">Terms of Service</span>
                            <span class="footer-link" onclick="showLegal('privacy')">Privacy Policy</span>
                            <span class="footer-link" onclick="showLegal('cookies')">Cookie Policy</span>
                            <span class="footer-link" onclick="showLegal('ads')">About Ads</span>
                            <span class="footer-link" onclick="showLegal('legal')">Legal Notice</span>
                        </div>
                    </footer>
                </div>

                <!-- SEARCH PAGE -->
                <div class="page" id="searchPage" role="main">
                    <h1 class="section-title">Search Results</h1>
                    <div class="search-results" id="searchResults"></div>
                </div>

                <!-- LIBRARY PAGE -->
                <div class="page" id="libraryPage" role="main">
                    <h1 class="section-title">Your Library</h1>
                    <div class="library-content">
                        <div class="quick-access-grid" style="margin-bottom: 32px;">
                            <div class="quick-access-item" onclick="showLikedSongs()">
                                <img src="https://misc.scdn.co/liked-songs/liked-songs-300.png" alt="Liked Songs">
                                <span>Liked Songs<br><span id="likedCountLib" style="color: var(--text-subdued); font-size: 14px;">0 songs</span></span>
                            </div>
                            <div class="quick-access-item" onclick="showRecentlyPlayed()">
                                <img src="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=300&h=300&fit=crop" alt="Recently Played">
                                <span>Recently Played<br><span id="recentCountLib" style="color: var(--text-subdued); font-size: 14px;">0 tracks</span></span>
                            </div>
                        </div>
                        <h2 class="section-subtitle" style="margin-top: 32px;">Your Playlists</h2>
                        <div class="recent-grid" id="userPlaylists"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- BOTTOM PLAYER -->
    <div class="bottom-player hidden" id="bottomPlayer">
        <div class="now-playing-section">
            <img class="now-playing-cover" id="currentArtwork" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='56' height='56'%3E%3Crect width='56' height='56' fill='%23282828'/%3E%3C/svg%3E" alt="Album artwork">
            <div class="now-playing-info">
                <div class="now-playing-title" id="currentTitle">No track playing</div>
                <div class="now-playing-artist" id="currentArtist">-</div>
            </div>
            <div class="now-playing-actions">
                <button class="now-playing-btn" id="likeBtn" onclick="toggleLike()" title="Like">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                    </svg>
                </button>
            </div>
        </div>

        <div class="player-controls-section">
            <div class="player-controls">
                <button class="control-btn" id="shuffleBtn" onclick="player.toggleShuffle()" title="Shuffle">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm.33 9.41l-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04-3.13-3.13z"/>
                    </svg>
                </button>
                <button class="control-btn" id="prevBtn" onclick="player.playPrevious()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/>
                    </svg>
                </button>
                <button class="control-btn play-btn" id="playPauseBtn" onclick="player.togglePlayPause()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M8 5v14l11-7z"/>
                    </svg>
                </button>
                <button class="control-btn" id="nextBtn" onclick="player.playNext()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/>
                    </svg>
                </button>
                <button class="control-btn" id="repeatBtn" onclick="player.toggleRepeat()" title="Repeat">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z"/>
                    </svg>
                </button>
            </div>

            <div class="playback-progress">
                <span class="time" id="currentTime">0:00</span>
                <div class="progress-bar" id="progressBar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <span class="time" id="totalTime">0:30</span>
            </div>
        </div>

        <div class="player-extras-section">
            <div class="volume-control">
                <svg class="volume-icon" viewBox="0 0 24 24">
                    <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
                </svg>
                <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="70" aria-label="Volume">
            </div>
        </div>

        <audio id="audioPlayer" preload="none"></audio>
    </div>

    <script>
        // ========================================
        // RIGHT SPOT PLAYER - FULLY FUNCTIONAL
        // ========================================
        class RightSpotPlayer {
            constructor() {
                // DOM Elements
                this.audioPlayer = document.getElementById('audioPlayer');
                this.bottomPlayer = document.getElementById('bottomPlayer');
                this.currentArtwork = document.getElementById('currentArtwork');
                this.currentTitle = document.getElementById('currentTitle');
                this.currentArtist = document.getElementById('currentArtist');
                this.playPauseBtn = document.getElementById('playPauseBtn');
                this.progressBar = document.getElementById('progressBar');
                this.progressFill = document.getElementById('progressFill');
                this.currentTimeEl = document.getElementById('currentTime');
                this.totalTimeEl = document.getElementById('totalTime');
                this.volumeSlider = document.getElementById('volumeSlider');
                this.searchInput = document.getElementById('searchInput');
                this.searchResults = document.getElementById('searchResults');
                this.likeBtn = document.getElementById('likeBtn');
                this.errorBanner = document.getElementById('errorBanner');
                this.errorMessage = document.getElementById('errorMessage');
                this.debugInfo = document.getElementById('debugInfo');

                // State
                this.currentTrack = null;
                this.isPlaying = false;
                this.isShuffled = false;
                this.isRepeating = false;
                this.likedSongs = JSON.parse(localStorage.getItem('likedSongs') || '[]');
                this.recentlyPlayed = JSON.parse(localStorage.getItem('recentlyPlayed') || '[]');
                this.hasInteracted = false;

                this.init();
            }

            init() {
                this.setupEventListeners();
                this.setupMediaSession();
                this.setupProgressBar();
                this.setupVolume();
                this.setupMobileMenu();
                this.loadHomeSections();
                this.updateLibraryStats();
            }

            showError(message, debug = '') {
                this.errorMessage.textContent = message;
                this.debugInfo.textContent = debug;
                this.errorBanner.classList.add('visible');
                setTimeout(() => this.errorBanner.classList.remove('visible'), 5000);
            }

            hideError() {
                this.errorBanner.classList.remove('visible');
            }

            setupEventListeners() {
                // Player controls
                this.playPauseBtn.addEventListener('click', () => this.togglePlayPause());
                
                // Search
                this.searchInput.addEventListener('input', (e) => {
                    clearTimeout(this.searchTimeout);
                    this.searchTimeout = setTimeout(() => this.searchTracks(e.target.value), 300);
                });
                
                // Navigation
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.switchPage(item.dataset.page);
                    });
                });
                
                // Keyboard shortcuts
                document.addEventListener('keydown', (e) => {
                    if (e.code === 'Space' && e.target.tagName !== 'INPUT') {
                        e.preventDefault();
                        this.togglePlayPause();
                    }
                });

                // Audio events
                this.audioPlayer.addEventListener('timeupdate', () => this.updateProgress());
                this.audioPlayer.addEventListener('loadedmetadata', () => this.updateDuration());
                this.audioPlayer.addEventListener('ended', () => this.onTrackEnded());
                this.audioPlayer.addEventListener('error', (e) => this.handleAudioError(e));
            }

            setupMobileMenu() {
                const menuToggle = document.getElementById('menuToggle');
                const sidebarBackdrop = document.getElementById('sidebarBackdrop');
                
                menuToggle.addEventListener('click', () => {
                    document.getElementById('sidebar').classList.add('visible');
                    sidebarBackdrop.classList.add('visible');
                });
                
                sidebarBackdrop.addEventListener('click', () => {
                    document.getElementById('sidebar').classList.remove('visible');
                    sidebarBackdrop.classList.remove('visible');
                });
            }

            setupMediaSession() {
                if (!('mediaSession' in navigator)) return;
                
                navigator.mediaSession.setActionHandler('play', () => this.play());
                navigator.mediaSession.setActionHandler('pause', () => this.pause());
                navigator.mediaSession.setActionHandler('previoustrack', () => this.playPrevious());
                navigator.mediaSession.setActionHandler('nexttrack', () => this.playNext());
            }

            setupProgressBar() {
                this.progressBar.addEventListener('click', (e) => {
                    if (!this.currentTrack || !this.audioPlayer.duration) return;
                    
                    const rect = this.progressBar.getBoundingClientRect();
                    const percent = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));
                    this.audioPlayer.currentTime = percent * this.audioPlayer.duration;
                    this.updateProgress();
                });
            }

            setupVolume() {
                const savedVolume = localStorage.getItem('volume');
                if (savedVolume !== null) {
                    this.audioPlayer.volume = parseFloat(savedVolume);
                    this.volumeSlider.value = parseFloat(savedVolume) * 100;
                } else {
                    this.audioPlayer.volume = 0.7;
                }
                
                this.volumeSlider.addEventListener('input', (e) => {
                    const volume = e.target.value / 100;
                    this.audioPlayer.volume = volume;
                    localStorage.setItem('volume', volume);
                });
            }

            async searchTracks(query) {
                if (!query.trim()) {
                    this.searchResults.innerHTML = '';
                    this.hideError();
                    return;
                }

                // Show loading state
                this.searchResults.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-subdued);">
                        <div style="margin-bottom: 16px;">üîç Searching...</div>
                        <div style="font-size: 12px;">Query: "${query}"</div>
                    </div>
                `;

                try {
                    // Try primary endpoint
                    const response = await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(query)}&media=music&entity=song&limit=50`);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                    const data = await response.json();
                    
                    if (data.results && data.results.length > 0) {
                        this.displaySearchResults(data.results);
                        this.hideError();
                    } else {
                        this.searchResults.innerHTML = `
                            <div style="text-align: center; padding: 40px; color: var(--text-subdued);">
                                <div style="margin-bottom: 16px;">üéµ No tracks found</div>
                                <div style="font-size: 12px;">Try searching for popular artists or songs</div>
                            </div>
                        `;
                    }
                } catch (error) {
                    console.error('Search error:', error);
                    this.showError(
                        `Search failed: ${error.message}`,
                        'Check console (F12) for details. Try: 1) Refresh page 2) Check internet 3) Search simpler terms'
                    );
                    
                    // Show fallback content
                    this.searchResults.innerHTML = `
                        <div style="text-align: center; padding: 40px;">
                            <div style="color: var(--essential-negative); margin-bottom: 16px;">‚ùå Search Error</div>
                            <div style="color: var(--text-subdued); font-size: 14px; margin-bottom: 24px;">
                                Unable to connect to music database
                            </div>
                            <button onclick="location.reload()" style="background: var(--accent-base); color: black; border: none; padding: 12px 24px; border-radius: 500px; font-weight: 700; cursor: pointer;">
                                Reload App
                            </button>
                        </div>
                    `;
                }
            }

            displaySearchResults(tracks) {
                this.searchResults.innerHTML = tracks.map(track => `
                    <div class="track-result-card" onclick="player.playTrack('${track.previewUrl}', '${this.escapeHtml(track.trackName)}', '${this.escapeHtml(track.artistName)}', '${track.artworkUrl600 || track.artworkUrl100 || 'https://via.placeholder.com/300'}')">
                        <img class="track-result-cover" src="${track.artworkUrl100 || 'https://via.placeholder.com/300'}" alt="${this.escapeHtml(track.trackName)}" loading="lazy">
                        <button class="track-result-play-btn" onclick="event.stopPropagation()">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>
                        </button>
                        <h3 class="track-result-title">${this.escapeHtml(track.trackName)}</h3>
                        <p class="track-result-artist">${this.escapeHtml(track.artistName)}</p>
                    </div>
                `).join('');
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML.replace(/'/g, "&#39;");
            }

            playTrack(previewUrl, title, artist, artwork) {
                if (!previewUrl) {
                    this.showError('No audio preview available', 'This track may not have a 30-second preview');
                    return;
                }

                this.currentTrack = { 
                    previewUrl, 
                    title, 
                    artist, 
                    artwork: artwork || 'https://via.placeholder.com/56'
                };
                
                // Show player
                this.bottomPlayer.classList.remove('hidden');
                
                // Set audio source
                this.audioPlayer.src = previewUrl;
                
                // Attempt playback
                this.audioPlayer.play().then(() => {
                    this.isPlaying = true;
                    this.updatePlayPauseButton();
                    this.updateNowPlaying();
                    this.updateMediaSession();
                    this.addToRecentlyPlayed();
                    this.checkIfLiked();
                    this.hideError();
                    
                    // Log success
                    console.log('‚úÖ Playing:', title, 'by', artist);
                    
                }).catch(error => {
                    console.error('Playback error:', error);
                    this.showError(
                        'Cannot play this track',
                        'It may be restricted or your browser blocked autoplay. Tap play to try again.'
                    );
                    
                    // Still update UI so user can manually play
                    this.currentArtwork.src = this.currentTrack.artwork;
                    this.currentTitle.textContent = this.currentTrack.title;
                    this.currentArtist.textContent = this.currentTrack.artist;
                    this.bottomPlayer.classList.remove('hidden');
                    this.isPlaying = false;
                    this.updatePlayPauseButton();
                });
            }

            togglePlayPause() {
                if (!this.currentTrack) return;
                
                if (this.isPlaying) {
                    this.pause();
                } else {
                    this.play();
                }
            }

            play() {
                if (!this.currentTrack) return;
                
                this.audioPlayer.play().then(() => {
                    this.isPlaying = true;
                    this.updatePlayPauseButton();
                    this.updateMediaSessionPlaybackState();
                    this.hideError();
                }).catch(error => {
                    console.error('Play error:', error);
                    this.showError('Playback failed. Tap again or try a different track.');
                });
            }

            pause() {
                if (!this.currentTrack) return;
                
                this.audioPlayer.pause();
                this.isPlaying = false;
                this.updatePlayPauseButton();
                this.updateMediaSessionPlaybackState();
            }

            updatePlayPauseButton() {
                const icon = this.playPauseBtn.querySelector('svg path');
                if (this.isPlaying) {
                    icon.setAttribute('d', 'M6 19h4V5H6v14zm8-14v14h4V5h-4z');
                    this.playPauseBtn.setAttribute('aria-label', 'Pause');
                } else {
                    icon.setAttribute('d', 'M8 5v14l11-7z');
                    this.playPauseBtn.setAttribute('aria-label', 'Play');
                }
            }

            updateNowPlaying() {
                if (!this.currentTrack) return;
                this.currentArtwork.src = this.currentTrack.artwork;
                this.currentTitle.textContent = this.currentTrack.title;
                this.currentArtist.textContent = this.currentTrack.artist;
            }

            updateProgress() {
                if (!this.currentTrack || !this.audioPlayer.duration) return;
                
                const progress = (this.audioPlayer.currentTime / this.audioPlayer.duration) * 100;
                this.progressFill.style.width = progress + '%';
                this.currentTimeEl.textContent = this.formatTime(this.audioPlayer.currentTime);
                this.totalTimeEl.textContent = this.formatTime(this.audioPlayer.duration);
            }

            updateDuration() {
                if (!this.audioPlayer.duration) return;
                this.totalTimeEl.textContent = this.formatTime(this.audioPlayer.duration);
            }

            formatTime(seconds) {
                if (isNaN(seconds)) return '0:00';
                const mins = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${mins}:${secs.toString().padStart(2, '0')}`;
            }

            handleAudioError(e) {
                console.error('Audio element error:', e);
                let errorMsg = 'Audio playback error';
                switch(this.audioPlayer.error?.code) {
                    case 1: errorMsg = 'Download aborted'; break;
                    case 2: errorMsg = 'Network error - check connection'; break;
                    case 3: errorMsg = 'Audio decoding error'; break;
                    case 4: errorMsg = 'Audio format not supported'; break;
                }
                this.showError(errorMsg, 'Try a different track or reload the page');
            }

            updateMediaSession() {
                if (!('mediaSession' in navigator) || !this.currentTrack) return;
                
                navigator.mediaSession.metadata = new MediaMetadata({
                    title: this.currentTrack.title,
                    artist: this.currentTrack.artist,
                    album: 'Right Spot',
                    artwork: [{ src: this.currentTrack.artwork, sizes: '512x512', type: 'image/jpeg' }]
                });
                this.updateMediaSessionPlaybackState();
            }

            updateMediaSessionPlaybackState() {
                if ('mediaSession' in navigator) {
                    navigator.mediaSession.playbackState = this.isPlaying ? 'playing' : 'paused';
                }
            }

            addToRecentlyPlayed() {
                if (!this.currentTrack) return;
                
                // Remove if exists, add to beginning
                this.recentlyPlayed = this.recentlyPlayed.filter(t => t.title !== this.currentTrack.title);
                this.recentlyPlayed.unshift({...this.currentTrack, timestamp: Date.now()});
                this.recentlyPlayed = this.recentlyPlayed.slice(0, 50);
                localStorage.setItem('recentlyPlayed', JSON.stringify(this.recentlyPlayed));
                this.updateLibraryStats();
            }

            checkIfLiked() {
                const isLiked = this.likedSongs.some(s => s.title === this.currentTrack.title);
                this.likeBtn.style.color = isLiked ? '#1ed760' : 'var(--text-subdued)';
            }

            updateLibraryStats() {
                document.getElementById('likedCount').textContent = this.likedSongs.length;
                document.getElementById('likedCountLib').textContent = `${this.likedSongs.length} songs`;
                document.getElementById('recentCount').textContent = this.recentlyPlayed.length;
                document.getElementById('recentCountLib').textContent = `${this.recentlyPlayed.length} tracks`;
            }

            switchPage(pageName) {
                document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
                document.querySelector(`[data-page="${pageName}"]`).classList.add('active');
                document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
                document.getElementById(`${pageName}Page`).classList.add('active');
                
                if (pageName === 'home') {
                    this.loadHomeSections();
                }
            }

            async loadHomeSections() {
                const sections = [
                    { id: 'recentGrid', term: 'pop' },
                    { id: 'madeForYouGrid', term: 'chill' },
                    { id: 'popularGrid', term: 'trending' }
                ];
                
                sections.forEach(section => {
                    this.loadSection(section.id, section.term);
                });
            }

            async loadSection(gridId, term) {
                try {
                    const response = await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(term)}&media=music&entity=song&limit=12`);
                    const data = await response.json();
                    const grid = document.getElementById(gridId);
                    grid.innerHTML = data.results.slice(0, 6).map(track => `
                        <div class="recent-item" onclick="player.playTrack('${track.previewUrl}', '${this.escapeHtml(track.trackName)}', '${this.escapeHtml(track.artistName)}', '${track.artworkUrl600 || track.artworkUrl100}')">
                            <img class="recent-item-cover" src="${track.artworkUrl100}" alt="${this.escapeHtml(track.trackName)}" loading="lazy">
                            <h3 class="recent-item-title">${this.escapeHtml(track.trackName)}</h3>
                            <p class="recent-item-subtitle">${this.escapeHtml(track.artistName)}</p>
                        </div>
                    `).join('');
                } catch (error) {
                    console.warn(`Failed to load ${gridId}:`, error);
                }
            }

            toggleShuffle() {
                this.isShuffled = !this.isShuffled;
                this.shuffleBtn.style.color = this.isShuffled ? 'var(--accent-base)' : 'var(--text-subdued)';
            }

            toggleRepeat() {
                this.isRepeating = !this.isRepeating;
                this.repeatBtn.style.color = this.isRepeating ? 'var(--accent-base)' : 'var(--text-subdued)';
            }

            playPrevious() {
                if (this.recentlyPlayed.length > 1) {
                    const prev = this.recentlyPlayed[1];
                    this.playTrack(prev.previewUrl, prev.title, prev.artist, prev.artwork);
                }
            }

            playNext() {
                if (this.recentlyPlayed.length > 0) {
                    const random = this.recentlyPlayed[Math.floor(Math.random() * Math.min(10, this.recentlyPlayed.length))];
                    this.playTrack(random.previewUrl, random.title, random.artist, random.artwork);
                }
            }

            onTrackEnded() {
                if (this.isRepeating) {
                    this.audioPlayer.currentTime = 0;
                    this.play();
                } else {
                    this.playNext();
                }
            }
        }

        // ========================================
        // GLOBAL FUNCTIONS - REAL FEATURES
        // ========================================
        const player = new RightSpotPlayer();

        function toggleLike() {
            if (!player.currentTrack) return;
            
            const index = player.likedSongs.findIndex(s => s.title === player.currentTrack.title);
            if (index === -1) {
                player.likedSongs.push({...player.currentTrack});
                player.likeBtn.style.color = '#1ed760';
            } else {
                player.likedSongs.splice(index, 1);
                player.likeBtn.style.color = 'var(--text-subdued)';
            }
            localStorage.setItem('likedSongs', JSON.stringify(player.likedSongs));
            player.updateLibraryStats();
        }

        function playLikedShuffle() {
            if (player.likedSongs.length === 0) {
                alert('No liked songs yet! Like some tracks first.');
                return;
            }
            const randomSong = player.likedSongs[Math.floor(Math.random() * player.likedSongs.length)];
            player.playTrack(randomSong.previewUrl, randomSong.title, randomSong.artist, randomSong.artwork);
        }

        function playRecent() {
            if (player.recentlyPlayed.length === 0) {
                alert('No recently played tracks yet!');
                return;
            }
            const lastPlayed = player.recentlyPlayed[0];
            player.playTrack(lastPlayed.previewUrl, lastPlayed.title, lastPlayed.artist, lastPlayed.artwork);
        }

        function searchGenre(genre) {
            player.switchPage('search');
            player.searchInput.value = genre;
            player.searchTracks(genre);
        }

        function showLikedSongs() {
            player.switchPage('library');
            const likedContainer = document.getElementById('userPlaylists');
            
            if (player.likedSongs.length === 0) {
                likedContainer.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 60px; color: var(--text-subdued);">
                        <div style="font-size: 48px; margin-bottom: 16px;">üéµ</div>
                        <div style="font-size: 18px; margin-bottom: 8px;">No liked songs yet</div>
                        <div style="font-size: 14px;">Like some tracks to see them here!</div>
                    </div>
                `;
                return;
            }
            
            likedContainer.innerHTML = player.likedSongs.map(song => `
                <div class="track-result-card" onclick="player.playTrack('${song.previewUrl}', '${player.escapeHtml(song.title)}', '${player.escapeHtml(song.artist)}', '${song.artwork}')">
                    <img class="track-result-cover" src="${song.artwork}" alt="${player.escapeHtml(song.title)}">
                    <button class="track-result-play-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>
                    </button>
                    <h3 class="track-result-title">${player.escapeHtml(song.title)}</h3>
                    <p class="track-result-artist">${player.escapeHtml(song.artist)}</p>
                </div>
            `).join('');
        }

        function showRecentlyPlayed() {
            if (player.recentlyPlayed.length === 0) {
                alert('No recently played tracks yet!');
                return;
            }
            player.switchPage('search');
            player.searchResults.innerHTML = player.recentlyPlayed.slice(0, 20).map(track => `
                <div class="track-result-card" onclick="player.playTrack('${track.previewUrl}', '${player.escapeHtml(track.title)}', '${player.escapeHtml(track.artist)}', '${track.artwork}')">
                    <img class="track-result-cover" src="${track.artwork}" alt="${player.escapeHtml(track.title)}">
                    <button class="track-result-play-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>
                    </button>
                    <h3 class="track-result-title">${player.escapeHtml(track.title)}</h3>
                    <p class="track-result-artist">${player.escapeHtml(track.artist)}</p>
                </div>
            `).join('');
        }

        function showLegal(type) {
            const content = {
                terms: `
                    <h3>Terms of Service</h3>
                    <p><strong>Last updated:</strong> January 1, 2025</p>
                    <p>By accessing or using Right Spot, you agree to these Terms. This is a demonstration music player application.</p>
                    <h3>1. Use License</h3>
                    <p>Permission is granted to use Right Spot for personal, non-commercial purposes. This application is for educational and demonstration purposes only.</p>
                    <h3>2. Music Content</h3>
                    <p>All audio previews are provided by Apple iTunes Search API. Tracks are limited to 30-second previews only. Full songs are not available. All rights belong to respective copyright holders.</p>
                    <h3>3. User Data</h3>
                    <p>Your data (liked songs, recently played) is stored <strong>locally in your browser</strong> using localStorage. No data is transmitted to external servers or collected by us.</p>
                    <h3>4. Limitations</h3>
                    <p>The service may be unavailable if the iTunes API is inaccessible. Track availability varies by region and licensing.</p>
                    <h3>5. No Warranty</h3>
                    <p>This application is provided "as is" without warranty. We are not responsible for any interruptions or errors in service.</p>
                `,
                privacy: `
                    <h3>Privacy Policy</h3>
                    <p><strong>Last updated:</strong> January 1, 2025</p>
                    <h3>1. No Data Collection</h3>
                    <p>Right Spot does <strong>not collect, store, or transmit</strong> any personal information. All data remains on your device.</p>
                    <h3>2. Local Storage Only</h3>
                    <p>We use browser localStorage to save:</p>
                    <ul style="margin-left: 20px; color: var(--text-subdued);">
                        <li>Liked songs (track metadata and artwork URLs)</li>
                        <li>Recently played tracks</li>
                        <li>Volume preferences</li>
                    </ul>
                    <h3>3. Third-Party API</h3>
                    <p>When you search, queries are sent to Apple's iTunes Search API. This is subject to Apple's privacy policy.</p>
                    <h3>4. No Tracking</h3>
                    <p>No cookies, analytics, or tracking technologies are used. Your listening history is private and stays on your device.</p>
                    <h3>5. Data Control</h3>
                    <p>Clear your browser data to remove all stored information. You have complete control over your data.</p>
                `,
                cookies: `
                    <h3>Cookie Policy</h3>
                    <p><strong>Last updated:</strong> January 1, 2025</p>
                    <h3>No Cookies Used</h3>
                    <p>Right Spot does not use cookies or similar tracking technologies.</p>
                    <h3>Local Storage Technology</h3>
                    <p>Instead of cookies, we use your browser's localStorage to store:</p>
                    <ul style="margin-left: 20px; color: var(--text-subdued);">
                        <li><strong>Liked Songs:</strong> Track metadata and artwork URLs</li>
                        <li><strong>Recently Played:</strong> Playback history</li>
                        <li><strong>Volume Settings:</strong> Your volume preference</li>
                    </ul>
                    <h3>How to Clear</h3>
                    <p>To delete this data, clear your browser's localStorage for this site:</p>
                    <ul style="margin-left: 20px; color: var(--text-subdued);">
                        <li>Chrome: Settings ‚Üí Privacy ‚Üí Clear browsing data ‚Üí Cookies and site data</li>
                        <li>Safari: Preferences ‚Üí Privacy ‚Üí Manage Website Data</li>
                        <li>Firefox: Settings ‚Üí Privacy ‚Üí Cookies and Site Data ‚Üí Clear Data</li>
                    </ul>
                `,
                ads: `
                    <h3>About Ads</h3>
                    <p><strong>Last updated:</strong> January 1, 2025</p>
                    <h3>No Advertising</h3>
                    <p>Right Spot contains <strong>no advertisements</strong> of any kind.</p>
                    <h3>Non-Commercial Application</h3>
                    <p>This is a free, open-source demonstration application built for educational purposes. It does not generate revenue.</p>
                    <h3>No Ad Tracking</h3>
                    <p>Since there are no ads, no ad tracking, targeting, or measurement technologies are used.</p>
                    <h3>Third-Party Content</h3>
                    <p>Music metadata and artwork are provided by Apple iTunes API. This content may include promotional artwork from artists and labels.</p>
                `,
                legal: `
                    <h3>Legal Notice</h3>
                    <p><strong>Last updated:</strong> January 1, 2025</p>
                    <h3>Copyright Information</h3>
                    <p>Right Spot is an independent project and is not affiliated with Spotify Inc. or Apple Inc. All trademarks belong to their respective owners.</p>
                    <h3>Music Content</h3>
                    <p>All audio previews, artwork, and metadata are provided by the Apple iTunes Search API and remain the property of their respective copyright holders.</p>
                    <h3>Fair Use</h3>
                    <p>This application provides 30-second previews only, which is consistent with iTunes' preview functionality for discovery purposes.</p>
                    <h3>Disclaimer</h3>
                    <p>This is a demonstration application. For full music streaming services, please use licensed platforms like Spotify, Apple Music, etc.</p>
                    <h3>Source Code</h3>
                    <p>This is a client-side only application. No backend servers are used. All code runs in your browser.</p>
                `
            };

            document.getElementById('modalTitle').textContent = {
                terms: 'Terms of Service',
                privacy: 'Privacy Policy',
                cookies: 'Cookie Policy',
                ads: 'About Ads',
                legal: 'Legal Notice'
            }[type];
            
            document.getElementById('modalContent').innerHTML = content[type];
            document.getElementById('legalModal').classList.add('visible');
        }

        function closeLegalModal() {
            document.getElementById('legalModal').classList.remove('visible');
        }

        // Load initial content
        player.loadHomeSections();
        
        // Debug: Log when page loads
        console.log('Right Spot initialized. Debug info:');
        console.log('User Agent:', navigator.userAgent);
        console.log('Online:', navigator.onLine);
        console.log('Supports Media Session:', 'mediaSession' in navigator);
        console.log('LocalStorage available:', typeof(Storage) !== 'undefined');
    </script>
</body>
</html>
